<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PizzaTyper</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap');

body { margin:0; font-family:'Courier Prime', monospace; background:#ffe5b4; display:flex; justify-content:center; align-items:flex-start; padding-top:50px;}
.container { max-width:800px; width:100%; background:#ff6347; padding:30px; border-radius:20px; box-shadow:0 0 20px rgba(0,0,0,0.5); color:#fff; position:relative;}
h1 { text-align:center; margin-bottom:20px; font-size:2em;}
h1::before { content:"üçï "; }
.stats { display:flex; justify-content:space-around; margin-bottom:20px; font-size:1.2em;}
.text-area { background:#fff8dc; padding:15px; min-height:150px; border-radius:10px; margin-bottom:20px; white-space:pre-wrap; font-size:1.2em; line-height:1.5; overflow-y:auto; color:#000; position:relative;}
span.correct { color:green; }
span.current { background:yellow; color:black; }
span.wrong { color:red; }
input[type="text"] { width:100%; padding:10px; font-size:1.2em; border-radius:10px; border:none; outline:none; margin-bottom:20px; background:#fff8dc; color:#000;}
input::placeholder { color:#b22222; }
button { padding:10px 20px; font-size:1em; border-radius:10px; border:none; cursor:pointer; background:#ffcc00; color:#000; font-weight:bold; margin-right:5px; transition:0.3s;}
button:hover { background:#ffd700; }
#results { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff8dc; color:#000; padding:30px; border-radius:15px; box-shadow:0 0 20px rgba(0,0,0,0.7); display:none; text-align:center;}
#results button { background:#ff6347; color:#fff; }
</style>
</head>
<body>
<div class="container">
<h1>PizzaTyper</h1>
<div class="stats">
<div>WPM: <span id="wpm">0</span></div>
<div>Accuracy: <span id="accuracy">100%</span></div>
<div>Errors: <span id="errors">0</span></div>
<div>Time: <span id="time">30</span>s</div>
</div>
<div class="text-area" id="textToType"></div>
<input type="text" id="userInput" placeholder="Tippe hier..." autocomplete="off">
</div>

<div id="results">
<h2>Ergebnis</h2>
<p>WPM: <span id="resWpm">0</span></p>
<p>Accuracy: <span id="resAcc">0%</span></p>
<p>Errors: <span id="resErr">0</span></p>
<button onclick="restartTest()">Neu starten</button>
</div>

<script>
const words = ["pizza","k√§se","tomate","basilikum","teig","st√ºck","ofen","hei√ü","lecker","frisch","knusprig","sauce","w√ºrzig","essen","mittag","abend","snack","abendessen","italienisch","belag"];
let fullText = "";
let timer, timeLeft, started=false;
let typedChars=0, errors=0;

const totalTime = 30;
const textDiv = document.getElementById("textToType");
const input = document.getElementById("userInput");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const errSpan = document.getElementById("errors");

const resultsDiv = document.getElementById("results");
const resWpm = document.getElementById("resWpm");
const resAcc = document.getElementById("resAcc");
const resErr = document.getElementById("resErr");

function generateText(){
    fullText = "";
    for(let i=0;i<50;i++) fullText += words[Math.floor(Math.random()*words.length)] + " ";
    fullText = fullText.trim();
    typedChars=0;
    errors=0;
    timeLeft=totalTime;
    started=false;
    input.value="";
    input.disabled=false;
    resultsDiv.style.display="none";
    updateDisplay();
    wpmSpan.textContent="0";
    accSpan.textContent="100%";
    errSpan.textContent="0";
    document.getElementById("time").textContent=totalTime;
}

function updateDisplay(){
    const chars = fullText.split('');
    let html = "";
    for(let i=0;i<chars.length;i++){
        if(i<typedChars-errors) html += `<span class="correct">${chars[i]}</span>`;
        else if(i===typedChars) html += `<span class="current">${chars[i]}</span>`;
        else html += `<span>${chars[i]}</span>`;
    }
    textDiv.innerHTML=html;
}

function startTimer(){
    if(started) return;
    started=true;
    timer=setInterval(()=>{
        timeLeft--;
        document.getElementById("time").textContent=timeLeft;
        if(timeLeft<=0) finishTest();
    },1000);
}

function finishTest(){
    clearInterval(timer);
    input.disabled=true;
    const wpm = typedChars/5;
    const accuracy = typedChars ? Math.max(0, Math.floor((typedChars-errors)/typedChars*100)) : 100;
    resWpm.textContent=wpm;
    resAcc.textContent=accuracy+"%";
    resErr.textContent=errors;
    resultsDiv.style.display="block";
}

function restartTest(){
    generateText();
    input.focus();
}

input.addEventListener("keydown",(e)=>{
    if(e.key==="Backspace" || e.ctrlKey || e.metaKey) e.preventDefault();
});

input.addEventListener("input",()=>{
    if(!started) startTimer();
    const value=input.value;
    const char=value[value.length-1];
    if(char===undefined) return;

    if(char===fullText[typedChars]) typedChars++;
    else { typedChars++; errors++; }

    wpmSpan.textContent = Math.floor(typedChars/5);
    const accuracy = typedChars ? Math.max(0, Math.floor((typedChars-errors)/typedChars*100)) : 100;
    accSpan.textContent = accuracy+"%";
    errSpan.textContent = errors;

    updateDisplay();

    if(typedChars>=fullText.length) finishTest();
});

generateText();
</script>
</body>
</html>
