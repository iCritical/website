<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PizzaTyper</title>
<link rel="icon" href="pizza.png" type="image/png">
<style>
@import url('https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap');

body {
  margin: 0;
  font-family: 'Courier Prime', monospace;
  background: #ffe5b4;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  max-width: 800px;
  width: 100%;
  background: #ff6347;
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  color: #fff;
}

h1 { text-align:center; margin-bottom:20px; font-size:2em; }
h1::before { content:"üçï "; }

.stats { display:flex; justify-content:space-around; margin-bottom:20px; font-size:1.2em; }

.text-area {
  background:#fff8dc;
  padding:15px;
  min-height:150px;
  border-radius:10px;
  margin-bottom:20px;
  white-space:pre-wrap;
  font-size:1.2em;
  line-height:1.5;
  overflow-y:auto;
  color:#000;
}

span.correct { color:green; }
span.current { background:yellow; color:black; }
span.wrong { color:red; }

input[type="text"], select {
  width:100%;
  padding:10px;
  font-size:1.2em;
  border-radius:10px;
  border:none;
  outline:none;
  margin-bottom:20px;
  background:#fff8dc;
  color:#000;
}

input::placeholder { color:#b22222; }

#results {
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:#fff8dc;
  color:#000;
  padding:30px;
  border-radius:15px;
  box-shadow:0 0 20px rgba(0,0,0,0.7);
  display:none;
  text-align:center;
}

#results button {
  background:#ff6347;
  color:#fff;
  padding:10px 20px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  margin-top:10px;
}
</style>
</head>
<body>
<div class="container">
<h1>PizzaTyper</h1>

<label for="duration">Testdauer (Minuten):</label>
<select id="duration">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="5">5</option>
</select>

<div class="stats">
  <div>WPM: <span id="wpm">0</span></div>
  <div>Accuracy: <span id="accuracy">100%</span></div>
  <div>Errors: <span id="errors">0</span></div>
  <div>Time: <span id="time">30</span>s</div>
</div>

<div class="text-area" id="textToType"></div>
<input type="text" id="userInput" placeholder="Tippe hier..." autocomplete="off">
</div>

<div id="results">
<h2>Ergebnis</h2>
<p>WPM: <span id="resWpm">0</span></p>
<p>Accuracy: <span id="resAcc">0%</span></p>
<p>Errors: <span id="resErr">0</span></p>
<button onclick="restartTest()">Neu starten</button>
</div>

<script>
const words = [
  "pizza","k√§se","tomate","basilikum","teig","st√ºck","ofen","hei√ü","lecker",
  "frisch","knusprig","sauce","w√ºrzig","essen","mittag","abend","snack","abendessen",
  "italienisch","belag","sch√∂nwetter","√ºberraschung","kr√§ftig","m√∂glichkeit","fu√üball","gr√∂√üer","√§sthetisch","vergn√ºgen",
  "z√ºchtig","g√§nsebl√ºmchen","sch√∂ngeistig","wissenschaftlich","gesch√§ftlich","verst√§ndnisvoll"
];

let fullText = "";
let typed = [];
let currentIndex = 0;
let errors = 0;
let timer, timeLeft, started=false;

const textDiv = document.getElementById("textToType");
const input = document.getElementById("userInput");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const errSpan = document.getElementById("errors");
const timeSpan = document.getElementById("time");
const durationSelect = document.getElementById("duration");

const resultsDiv = document.getElementById("results");
const resWpm = document.getElementById("resWpm");
const resAcc = document.getElementById("resAcc");
const resErr = document.getElementById("resErr");

function generateText() {
  fullText = "";
  for(let i=0;i<100;i++) fullText += words[Math.floor(Math.random()*words.length)] + " ";
  fullText = fullText.trim();
  typed = [];
  currentIndex = 0;
  errors = 0;
  timeLeft = durationSelect.value * 60;
  started = false;
  input.value="";
  input.disabled=false;
  updateDisplay();
  wpmSpan.textContent="0";
  accSpan.textContent="100%";
  errSpan.textContent="0";
  timeSpan.textContent=timeLeft;
  resultsDiv.style.display="none";
}

function updateDisplay() {
  textDiv.innerHTML = "";
  for(let i=0;i<fullText.length;i++) {
    let span = document.createElement("span");
    if(i < typed.length) {
      span.textContent = fullText[i];
      span.className = typed[i] === fullText[i] ? "correct" : "wrong";
    } else if(i===typed.length) {
      span.textContent = fullText[i];
      span.className = "current";
    } else {
      span.textContent = fullText[i];
    }
    textDiv.appendChild(span);
  }
}

function startTimer() {
  if(started) return;
  started = true;
  timer = setInterval(()=>{
    timeLeft--;
    timeSpan.textContent = timeLeft;
    if(timeLeft<=0) finishTest();
  },1000);
}

function finishTest() {
  clearInterval(timer);
  input.disabled=true;
  const wpm = Math.floor(typed.length/5 / (durationSelect.value));
  const accuracy = typed.length ? Math.floor((typed.length - errors)/typed.length*100) : 100;
  resWpm.textContent = wpm;
  resAcc.textContent = accuracy+"%";
  resErr.textContent = errors;
  resultsDiv.style.display="block";
}

function restartTest() {
  generateText();
  input.focus();
}

input.addEventListener("keydown",(e)=>{
  if(e.key==="Backspace" || e.ctrlKey || e.metaKey) e.preventDefault();
});

input.addEventListener("input", ()=>{
  if(!started) startTimer();
  const char = input.value[input.value.length-1];
  if(char === undefined) return;

  typed.push(char);
  if(char !== fullText[currentIndex]) errors++;
  currentIndex++;
  updateDisplay();
  wpmSpan.textContent = Math.floor(typed.length/5);
  const accuracy = typed.length ? Math.floor((typed.length-errors)/typed.length*100) : 100;
  accSpan.textContent = accuracy+"%";
  errSpan.textContent = errors;

  if(currentIndex>=fullText.length) finishTest();
});

// Regenerate text if duration changes
durationSelect.addEventListener("change", generateText);

// Initialize
generateText();
input.focus();
</script>
</body>
</html>
